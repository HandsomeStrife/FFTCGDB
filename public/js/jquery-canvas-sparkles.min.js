/*!
 * jquery-canvas-sparkles - v1.0.1 - 2015-01-23
 *
 * https://github.com/simeydotme/jQuery-canvas-sparkles
 * Copyright (c) 2015 Simon Goellner;
 *
 */

$(function(){"use strict";function a(a,b){this.options=b,this.init(a)}$.fn.sparkle=function(b){return this.each(function(c,d){var e=$(d),f=$.extend({color:"#FFFFFF",count:30,overlap:0,speed:1,minSize:4,maxSize:7,direction:"both"},b),g=new a(e,f);e.on({"mouseover.sparkle focus.sparkle":function(){e.trigger("start.sparkle")},"mouseout.sparkle blur.sparkle":function(){e.trigger("stop.sparkle")},"start.sparkle":function(){g.start(e)},"stop.sparkle":function(){g.stop()},"resize.sparkle":function(){g.resize(e),g.setParticles()}})})},a.prototype={init:function(a){var b={position:"absolute",top:"-"+this.options.overlap+"px",left:"-"+this.options.overlap+"px","pointer-events":"none"};if("static"===a.css("position")&&a.css("position","relative"),this.$canvas=$("<canvas>").addClass("sparkle-canvas").css(b).hide(),"auto"!==a.css("z-index")){var c=parseInt(a.css("z-index"),10);this.$canvas.css("z-index",c+1)}var d="IMG|BR|HR|INPUT",e="\\b"+a[0].nodeName+"\\b";this.isSingleton=new RegExp(e).test(d),this.isSingleton?this.$canvas.insertAfter(a):this.$canvas.appendTo(a),this.canvas=this.$canvas[0],this.context=this.canvas.getContext("2d"),this.sprite=new Image,this.sprite.src=this.datauri,this.spriteCoords=[0,6,13,20],this.canvas.width=1.2*a.outerWidth(),this.canvas.height=1.2*a.outerHeight(),this.setParticles(),this.anim=null,this.fade=!1},randomParticleSize:function(){return Math.floor(Math.random()*(this.options.maxSize-this.options.minSize+1)+this.options.minSize)},randomHexColor:function(){return"#"+("000000"+Math.floor(16777215*Math.random()).toString(16)).slice(-6)},setParticles:function(){this.particles=this.createSparkles(this.canvas.width,this.canvas.height)},createSparkles:function(a,b){for(var c=[],d=0;d<this.options.count;d++){var e;e="rainbow"===this.options.color?this.randomHexColor():"array"===$.type(this.options.color)?this.options.color[Math.floor(Math.random()*this.options.color.length)]:this.options.color;var f=Math.floor(1e3*Math.random())-500;"down"===this.options.direction?f=Math.floor(500*Math.random())-550:"up"===this.options.direction&&(f=Math.floor(500*Math.random())+50),c[d]={position:{x:Math.floor(Math.random()*a),y:Math.floor(Math.random()*b)},style:this.spriteCoords[Math.floor(Math.random()*this.spriteCoords.length)],delta:{x:Math.floor(1e3*Math.random())-500,y:f},size:this.randomParticleSize(),color:e}}return c},draw:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var a=0;a<this.particles.length;a++)this.context.save(),this.context.globalAlpha=this.particles[a].opacity,this.context.drawImage(this.sprite,this.particles[a].style,0,7,7,this.particles[a].position.x,this.particles[a].position.y,this.particles[a].size,this.particles[a].size),this.options.color&&(this.context.globalCompositeOperation="source-atop",this.context.globalAlpha=.6,this.context.fillStyle=this.particles[a].color,this.context.fillRect(this.particles[a].position.x,this.particles[a].position.y,7,7)),this.context.restore()},update:function(){var a=this;this.anim=window.requestAnimationFrame(function(b){for(var c=Math.floor(b),d=0;d<a.particles.length;d++){var e=a.particles[d],f=!1,g=Math.random()>2*Math.random(),h=Math.random()<5*Math.random();g&&(e.position.x+=e.delta.x*a.options.speed/1500),h&&(e.position.y-=e.delta.y*a.options.speed/800),e.position.x>a.canvas.width?(e.position.x=-a.options.maxSize,f=!0):e.position.x<-a.options.maxSize&&(e.position.x=a.canvas.width,f=!0),e.position.y>a.canvas.height?(e.position.y=-a.options.maxSize,e.position.x=Math.floor(Math.random()*a.canvas.width),f=!0):e.position.y<-a.options.maxSize&&(e.position.y=a.canvas.height,e.position.x=Math.floor(Math.random()*a.canvas.width),f=!0),f&&(e.size=a.randomParticleSize(),e.opacity=.4),e.opacity-=a.fade?.035:.005,e.opacity<=.15&&(e.opacity=a.fade?0:1.2),c%Math.floor(7*Math.random()+1)===0&&(e.style=a.spriteCoords[Math.floor(Math.random()*a.spriteCoords.length)])}a.draw(b),a.fade?(a.fadeCount-=1,a.fadeCount<0?(window.cancelAnimationFrame(a.anim),a.$canvas.hide()):a.update()):a.update()})},resize:function(a){this.canvas.width=a.outerWidth()+2*this.options.overlap,this.canvas.height=a.outerHeight()+2*this.options.overlap,this.isSingleton&&this.$canvas.css({top:a.position().top-this.options.overlap,left:a.position().left-this.options.overlap})},start:function(a){this.resize(a),this.$canvas.show(),window.cancelAnimationFrame(this.anim);for(var b=0;b<this.options.count;b++)this.particles[b].opacity=Math.random();this.fade=!1,this.update()},stop:function(){this.fade=!0,this.fadeCount=100},datauri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAHCAYAAAD5wDa1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNDNFMzM5REEyMkUxMUUzOEE3NEI3Q0U1QUIzMTc4NiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNDNFMzM5RUEyMkUxMUUzOEE3NEI3Q0U1QUIzMTc4NiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM0M0UzMzlCQTIyRTExRTM4QTc0QjdDRTVBQjMxNzg2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjM0M0UzMzlDQTIyRTExRTM4QTc0QjdDRTVBQjMxNzg2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jzOsUQAAANhJREFUeNqsks0KhCAUhW/Sz6pFSc1AD9HL+OBFbdsVOKWLajH9EE7GFBEjOMxcUNHD8dxPBCEE/DKyLGMqraoqcd4j0ChpUmlBEGCFRBzH2dbj5JycJAn90CEpy1J2SK4apVSM4yiKonhePYwxMU2TaJrm8BpykpWmKQ3D8FbX9SOO4/tOhDEG0zRhGAZo2xaiKDLyPGeSyPM8sCxr868+WC/mvu9j13XBtm1ACME8z7AsC/R9r0fGOf+arOu6jUwS7l6tT/B+xo+aDFRo5BykHfav3/gSYAAtIdQ1IT0puAAAAABJRU5ErkJggg=="}});